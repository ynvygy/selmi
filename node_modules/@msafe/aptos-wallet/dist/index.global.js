"use strict";var MSafeWallet=(()=>{var Pe=Object.create;var er=Object.defineProperty;var Fe=Object.getOwnPropertyDescriptor;var Re=Object.getOwnPropertyNames;var Te=Object.getPrototypeOf,Ne=Object.prototype.hasOwnProperty;var U=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports),_e=(t,r)=>{for(var e in r)er(t,e,{get:r[e],enumerable:!0})},Or=(t,r,e,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of Re(r))!Ne.call(t,i)&&i!==e&&er(t,i,{get:()=>r[i],enumerable:!(n=Fe(r,i))||n.enumerable});return t};var hr=(t,r,e)=>(e=t!=null?Pe(Te(t)):{},Or(r||!t||!t.__esModule?er(e,"default",{value:t,enumerable:!0}):e,t)),ve=t=>Or(er({},"__esModule",{value:!0}),t);var jr=U((dr,Lr)=>{"use strict";var kr=typeof Reflect!="undefined"?Reflect.construct:void 0,D=Object.defineProperty,lr=Error.captureStackTrace;lr===void 0&&(lr=function(r){var e=new Error;D(r,"stack",{configurable:!0,get:function(){var i=e.stack;return D(this,"stack",{configurable:!0,value:i,writable:!0}),i},set:function(i){D(r,"stack",{configurable:!0,value:i,writable:!0})}})});function tr(t){t!==void 0&&D(this,"message",{configurable:!0,value:t,writable:!0});var r=this.constructor.name;r!==void 0&&r!==this.name&&D(this,"name",{configurable:!0,value:r,writable:!0}),lr(this,this.constructor)}tr.prototype=Object.create(Error.prototype,{constructor:{configurable:!0,value:tr,writable:!0}});var Dr=function(){function t(e,n){return D(e,"name",{configurable:!0,value:n})}try{var r=function(){};if(t(r,"foo"),r.name==="foo")return t}catch(e){}}();function Ce(t,r){if(r==null||r===Error)r=tr;else if(typeof r!="function")throw new TypeError("super_ should be a function");var e;if(typeof t=="string")e=t,t=kr!==void 0?function(){return kr(r,arguments,this.constructor)}:function(){r.apply(this,arguments)},Dr!==void 0&&(Dr(t,e),e=void 0);else if(typeof t!="function")throw new TypeError("constructor should be either a string or a function");t.super_=t.super=r;var n={constructor:{configurable:!0,value:t,writable:!0}};return e!==void 0&&(n.name={configurable:!0,value:e,writable:!0}),t.prototype=Object.create(r.prototype,n),t}dr=Lr.exports=Ce;dr.BaseError=tr});var nr=U(m=>{"use strict";var Y=m&&m.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(r,e)};return function(r,e){t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(m,"__esModule",{value:!0});m.InvalidParameters=m.MethodNotFound=m.InvalidRequest=m.InvalidJson=m.JsonRpcError=void 0;var Me=jr(),Q=function(t){Y(r,t);function r(e,n,i){e===void 0&&(e="unknown error from the peer"),n===void 0&&(n=-32e3);var o=t.call(this,e)||this;return o.code=n,o.data=i,o}return r.prototype.toJsonRpcError=function(){return{code:this.code,data:this.data,message:this.message}},r}(Me.BaseError);m.JsonRpcError=Q;var Oe=function(t){Y(r,t);function r(){return t.call(this,"invalid JSON",-32700)||this}return r}(Q);m.InvalidJson=Oe;var ke=function(t){Y(r,t);function r(e){return e===void 0&&(e="invalid JSON-RPC request"),t.call(this,e,-32600)||this}return r}(Q);m.InvalidRequest=ke;var De=function(t){Y(r,t);function r(e){var n=this,i=e?"method not found: "+e:"method not found";return n=t.call(this,i,-32601,e)||this,n}return r}(Q);m.MethodNotFound=De;var Le=function(t){Y(r,t);function r(e){return t.call(this,"invalid parameter(s)",-32602,e)||this}return r}(Q);m.InvalidParameters=Le});var qr=U(S=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});S.response=S.request=S.notification=S.error=void 0;var je=nr(),ir=JSON.stringify;S.error=function(t,r){(r==null||typeof r.toJsonRpcError!="function")&&(r=new je.JsonRpcError);var e=r.toJsonRpcError();return ir({error:e,id:t,jsonrpc:"2.0"})};S.notification=function(t,r){return ir({jsonrpc:"2.0",method:t,params:r})};S.request=function(t,r,e){return ir({id:t,jsonrpc:"2.0",method:r,params:e})};S.response=function(t,r){return ir({id:t,jsonrpc:"2.0",result:r})}});var Jr=U($r=>{"use strict";Object.defineProperty($r,"__esModule",{value:!0})});var Hr=U(x=>{"use strict";Object.defineProperty(x,"__esModule",{value:!0});x.isObject=x.isString=x.isInteger=x.isNumber=void 0;var qe=Number.NEGATIVE_INFINITY,$e=Number.POSITIVE_INFINITY;x.isNumber=function(t){var r=typeof t;return r==="number"&&t>qe&&t<$e};x.isInteger=function(t){return x.isNumber(t)&&t%1===0};x.isString=function(t){return typeof t=="string"};x.isObject=function(t){var r=typeof t;return t!==null&&(r==="object"||r==="function")}});var Wr=U(y=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0});y.parse=y.isResponsePayload=y.isErrorPayload=y.isRequestPayload=y.isNotificationPayload=void 0;var P=Hr(),_=nr(),Je=Object.defineProperty,or=function(t,r){return Je(t,"type",{configurable:!0,value:r,writable:!0})},L=function(t){return t===null?"null":typeof t},He=function(t,r){if(r==="1.0"){if(t==null)throw new _.InvalidRequest("invalid error "+L(t))}else if(t==null||!P.isInteger(t.code)||!P.isString(t.message))throw new _.InvalidRequest("invalid error: "+L(t)+" instead of {code, message}")},yr=function(t){if(!P.isNumber(t)&&!P.isString(t))throw new _.InvalidRequest("invalid identifier: "+L(t)+" instead of number or string")},Kr=function(t,r){if(r==="2.0"){if(t!==void 0&&!Array.isArray(t)&&!P.isObject(t))throw new _.InvalidRequest("invalid params: "+L(t)+" instead of undefined, array or object")}else if(!Array.isArray(t))throw new _.InvalidRequest("invalid params: "+L(t)+" instead of array")},Ke=function(t){var r=t.jsonrpc;if(r===void 0)return"1.0";if(r==="2.0")return"2.0";throw new _.InvalidRequest("invalid version: "+L(r)+" instead of undefined or '2.0'")},Vr=function(t,r){return t===(r==="2.0"?void 0:null)},Gr=function(t,r){var e=t.error;return e!==(r==="2.0"?void 0:null)};y.isNotificationPayload=function(t,r){if(P.isString(t.method)){var e=t.id;if(Vr(e,r))return Kr(t.params,r),!0}return!1};y.isRequestPayload=function(t,r){if(P.isString(t.method)){var e=t.id;if(!Vr(e,r))return yr(e),Kr(t.params,r),!0}return!1};y.isErrorPayload=function(t,r){if(!P.isString(t.method)&&Gr(t,r)){var e=t.id;return e!==null&&yr(e),He(t.error,r),!0}return!1};y.isResponsePayload=function(t,r){return!P.isString(t.method)&&!Gr(t,r)?(yr(t.id),!0):!1};function X(t){if(P.isString(t))try{t=JSON.parse(t)}catch(e){throw e instanceof SyntaxError?new _.InvalidJson:e}if(Array.isArray(t))return t.map(X);var r=Ke(t);if(y.isNotificationPayload(t,r))or(t,"notification");else if(y.isRequestPayload(t,r))or(t,"request");else if(y.isErrorPayload(t,r))or(t,"error");else if(y.isResponsePayload(t,r))or(t,"response");else throw new _.InvalidJson;return t}y.parse=X;y.default=X;X.result=function(r){var e=X(r);if(!Array.isArray(e)){if(e.type==="error")throw e.error;if(e.type==="response")return e.result}throw new TypeError("message should be response or error JSON-RPC message")}});var gr=U(g=>{"use strict";var Yr=g&&g.__createBinding||(Object.create?function(t,r,e,n){n===void 0&&(n=e),Object.defineProperty(t,n,{enumerable:!0,get:function(){return r[e]}})}:function(t,r,e,n){n===void 0&&(n=e),t[n]=r[e]}),Ve=g&&g.__setModuleDefault||(Object.create?function(t,r){Object.defineProperty(t,"default",{enumerable:!0,value:r})}:function(t,r){t.default=r}),Ge=g&&g.__importStar||function(t){if(t&&t.__esModule)return t;var r={};if(t!=null)for(var e in t)e!=="default"&&Object.hasOwnProperty.call(t,e)&&Yr(r,t,e);return Ve(r,t),r},Qr=g&&g.__exportStar||function(t,r){for(var e in t)e!=="default"&&!r.hasOwnProperty(e)&&Yr(r,t,e)};Object.defineProperty(g,"__esModule",{value:!0});g.format=void 0;var We=Ge(qr());g.format=We;Qr(Jr(),g);Qr(nr(),g);var Ye=Wr();Object.defineProperty(g,"parse",{enumerable:!0,get:function(){return Ye.parse}})});var Zr=U(sr=>{"use strict";sr.byteLength=Xe;sr.toByteArray=Ze;sr.fromByteArray=tt;var F=[],A=[],Qe=typeof Uint8Array!="undefined"?Uint8Array:Array,mr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(C=0,Xr=mr.length;C<Xr;++C)F[C]=mr[C],A[mr.charCodeAt(C)]=C;var C,Xr;A["-".charCodeAt(0)]=62;A["_".charCodeAt(0)]=63;function zr(t){var r=t.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=t.indexOf("=");e===-1&&(e=r);var n=e===r?0:4-e%4;return[e,n]}function Xe(t){var r=zr(t),e=r[0],n=r[1];return(e+n)*3/4-n}function ze(t,r,e){return(r+e)*3/4-e}function Ze(t){var r,e=zr(t),n=e[0],i=e[1],o=new Qe(ze(t,n,i)),s=0,c=i>0?n-4:n,a;for(a=0;a<c;a+=4)r=A[t.charCodeAt(a)]<<18|A[t.charCodeAt(a+1)]<<12|A[t.charCodeAt(a+2)]<<6|A[t.charCodeAt(a+3)],o[s++]=r>>16&255,o[s++]=r>>8&255,o[s++]=r&255;return i===2&&(r=A[t.charCodeAt(a)]<<2|A[t.charCodeAt(a+1)]>>4,o[s++]=r&255),i===1&&(r=A[t.charCodeAt(a)]<<10|A[t.charCodeAt(a+1)]<<4|A[t.charCodeAt(a+2)]>>2,o[s++]=r>>8&255,o[s++]=r&255),o}function rt(t){return F[t>>18&63]+F[t>>12&63]+F[t>>6&63]+F[t&63]}function et(t,r,e){for(var n,i=[],o=r;o<e;o+=3)n=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(t[o+2]&255),i.push(rt(n));return i.join("")}function tt(t){for(var r,e=t.length,n=e%3,i=[],o=16383,s=0,c=e-n;s<c;s+=o)i.push(et(t,s,s+o>c?c:s+o));return n===1?(r=t[e-1],i.push(F[r>>2]+F[r<<4&63]+"==")):n===2&&(r=(t[e-2]<<8)+t[e-1],i.push(F[r>>10]+F[r>>4&63]+F[r<<2&63]+"=")),i.join("")}});var re=U(wr=>{wr.read=function(t,r,e,n,i){var o,s,c=i*8-n-1,a=(1<<c)-1,f=a>>1,p=-7,h=e?i-1:0,I=e?-1:1,b=t[r+h];for(h+=I,o=b&(1<<-p)-1,b>>=-p,p+=c;p>0;o=o*256+t[r+h],h+=I,p-=8);for(s=o&(1<<-p)-1,o>>=-p,p+=n;p>0;s=s*256+t[r+h],h+=I,p-=8);if(o===0)o=1-f;else{if(o===a)return s?NaN:(b?-1:1)*(1/0);s=s+Math.pow(2,n),o=o-f}return(b?-1:1)*s*Math.pow(2,o-n)};wr.write=function(t,r,e,n,i,o){var s,c,a,f=o*8-i-1,p=(1<<f)-1,h=p>>1,I=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=n?0:o-1,pr=n?1:-1,Se=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(c=isNaN(r)?1:0,s=p):(s=Math.floor(Math.log(r)/Math.LN2),r*(a=Math.pow(2,-s))<1&&(s--,a*=2),s+h>=1?r+=I/a:r+=I*Math.pow(2,1-h),r*a>=2&&(s++,a/=2),s+h>=p?(c=0,s=p):s+h>=1?(c=(r*a-1)*Math.pow(2,i),s=s+h):(c=r*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[e+b]=c&255,b+=pr,c/=256,i-=8);for(s=s<<i|c,f+=i;f>0;t[e+b]=s&255,b+=pr,s/=256,f-=8);t[e+b-pr]|=Se*128}});var me=U(J=>{"use strict";var Ar=Zr(),q=re(),ee=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;J.Buffer=u;J.SlowBuffer=ct;J.INSPECT_MAX_BYTES=50;var ur=2147483647;J.kMaxLength=ur;u.TYPED_ARRAY_SUPPORT=nt();!u.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function nt(){try{let t=new Uint8Array(1),r={foo:function(){return 42}};return Object.setPrototypeOf(r,Uint8Array.prototype),Object.setPrototypeOf(t,r),t.foo()===42}catch(t){return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(!!u.isBuffer(this))return this.buffer}});Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(!!u.isBuffer(this))return this.byteOffset}});function N(t){if(t>ur)throw new RangeError('The value "'+t+'" is invalid for option "size"');let r=new Uint8Array(t);return Object.setPrototypeOf(r,u.prototype),r}function u(t,r,e){if(typeof t=="number"){if(typeof r=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Ir(t)}return oe(t,r,e)}u.poolSize=8192;function oe(t,r,e){if(typeof t=="string")return ot(t,r);if(ArrayBuffer.isView(t))return st(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(R(t,ArrayBuffer)||t&&R(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(R(t,SharedArrayBuffer)||t&&R(t.buffer,SharedArrayBuffer)))return Er(t,r,e);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=t.valueOf&&t.valueOf();if(n!=null&&n!==t)return u.from(n,r,e);let i=ut(t);if(i)return i;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return u.from(t[Symbol.toPrimitive]("string"),r,e);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}u.from=function(t,r,e){return oe(t,r,e)};Object.setPrototypeOf(u.prototype,Uint8Array.prototype);Object.setPrototypeOf(u,Uint8Array);function se(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function it(t,r,e){return se(t),t<=0?N(t):r!==void 0?typeof e=="string"?N(t).fill(r,e):N(t).fill(r):N(t)}u.alloc=function(t,r,e){return it(t,r,e)};function Ir(t){return se(t),N(t<0?0:br(t)|0)}u.allocUnsafe=function(t){return Ir(t)};u.allocUnsafeSlow=function(t){return Ir(t)};function ot(t,r){if((typeof r!="string"||r==="")&&(r="utf8"),!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r);let e=ue(t,r)|0,n=N(e),i=n.write(t,r);return i!==e&&(n=n.slice(0,i)),n}function xr(t){let r=t.length<0?0:br(t.length)|0,e=N(r);for(let n=0;n<r;n+=1)e[n]=t[n]&255;return e}function st(t){if(R(t,Uint8Array)){let r=new Uint8Array(t);return Er(r.buffer,r.byteOffset,r.byteLength)}return xr(t)}function Er(t,r,e){if(r<0||t.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<r+(e||0))throw new RangeError('"length" is outside of buffer bounds');let n;return r===void 0&&e===void 0?n=new Uint8Array(t):e===void 0?n=new Uint8Array(t,r):n=new Uint8Array(t,r,e),Object.setPrototypeOf(n,u.prototype),n}function ut(t){if(u.isBuffer(t)){let r=br(t.length)|0,e=N(r);return e.length===0||t.copy(e,0,0,r),e}if(t.length!==void 0)return typeof t.length!="number"||Sr(t.length)?N(0):xr(t);if(t.type==="Buffer"&&Array.isArray(t.data))return xr(t.data)}function br(t){if(t>=ur)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ur.toString(16)+" bytes");return t|0}function ct(t){return+t!=t&&(t=0),u.alloc(+t)}u.isBuffer=function(r){return r!=null&&r._isBuffer===!0&&r!==u.prototype};u.compare=function(r,e){if(R(r,Uint8Array)&&(r=u.from(r,r.offset,r.byteLength)),R(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(r)||!u.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(r===e)return 0;let n=r.length,i=e.length;for(let o=0,s=Math.min(n,i);o<s;++o)if(r[o]!==e[o]){n=r[o],i=e[o];break}return n<i?-1:i<n?1:0};u.isEncoding=function(r){switch(String(r).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};u.concat=function(r,e){if(!Array.isArray(r))throw new TypeError('"list" argument must be an Array of Buffers');if(r.length===0)return u.alloc(0);let n;if(e===void 0)for(e=0,n=0;n<r.length;++n)e+=r[n].length;let i=u.allocUnsafe(e),o=0;for(n=0;n<r.length;++n){let s=r[n];if(R(s,Uint8Array))o+s.length>i.length?(u.isBuffer(s)||(s=u.from(s)),s.copy(i,o)):Uint8Array.prototype.set.call(i,s,o);else if(u.isBuffer(s))s.copy(i,o);else throw new TypeError('"list" argument must be an Array of Buffers');o+=s.length}return i};function ue(t,r){if(u.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||R(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let e=t.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&e===0)return 0;let i=!1;for(;;)switch(r){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":return Br(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return e*2;case"hex":return e>>>1;case"base64":return ge(t).length;default:if(i)return n?-1:Br(t).length;r=(""+r).toLowerCase(),i=!0}}u.byteLength=ue;function at(t,r,e){let n=!1;if((r===void 0||r<0)&&(r=0),r>this.length||((e===void 0||e>this.length)&&(e=this.length),e<=0)||(e>>>=0,r>>>=0,e<=r))return"";for(t||(t="utf8");;)switch(t){case"hex":return At(this,r,e);case"utf8":case"utf-8":return ae(this,r,e);case"ascii":return mt(this,r,e);case"latin1":case"binary":return wt(this,r,e);case"base64":return yt(this,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return xt(this,r,e);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}u.prototype._isBuffer=!0;function M(t,r,e){let n=t[r];t[r]=t[e],t[e]=n}u.prototype.swap16=function(){let r=this.length;if(r%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<r;e+=2)M(this,e,e+1);return this};u.prototype.swap32=function(){let r=this.length;if(r%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<r;e+=4)M(this,e,e+3),M(this,e+1,e+2);return this};u.prototype.swap64=function(){let r=this.length;if(r%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<r;e+=8)M(this,e,e+7),M(this,e+1,e+6),M(this,e+2,e+5),M(this,e+3,e+4);return this};u.prototype.toString=function(){let r=this.length;return r===0?"":arguments.length===0?ae(this,0,r):at.apply(this,arguments)};u.prototype.toLocaleString=u.prototype.toString;u.prototype.equals=function(r){if(!u.isBuffer(r))throw new TypeError("Argument must be a Buffer");return this===r?!0:u.compare(this,r)===0};u.prototype.inspect=function(){let r="",e=J.INSPECT_MAX_BYTES;return r=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(r+=" ... "),"<Buffer "+r+">"};ee&&(u.prototype[ee]=u.prototype.inspect);u.prototype.compare=function(r,e,n,i,o){if(R(r,Uint8Array)&&(r=u.from(r,r.offset,r.byteLength)),!u.isBuffer(r))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof r);if(e===void 0&&(e=0),n===void 0&&(n=r?r.length:0),i===void 0&&(i=0),o===void 0&&(o=this.length),e<0||n>r.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&e>=n)return 0;if(i>=o)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,i>>>=0,o>>>=0,this===r)return 0;let s=o-i,c=n-e,a=Math.min(s,c),f=this.slice(i,o),p=r.slice(e,n);for(let h=0;h<a;++h)if(f[h]!==p[h]){s=f[h],c=p[h];break}return s<c?-1:c<s?1:0};function ce(t,r,e,n,i){if(t.length===0)return-1;if(typeof e=="string"?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,Sr(e)&&(e=i?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(i)return-1;e=t.length-1}else if(e<0)if(i)e=0;else return-1;if(typeof r=="string"&&(r=u.from(r,n)),u.isBuffer(r))return r.length===0?-1:te(t,r,e,n,i);if(typeof r=="number")return r=r&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(t,r,e):Uint8Array.prototype.lastIndexOf.call(t,r,e):te(t,[r],e,n,i);throw new TypeError("val must be string, number or Buffer")}function te(t,r,e,n,i){let o=1,s=t.length,c=r.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(t.length<2||r.length<2)return-1;o=2,s/=2,c/=2,e/=2}function a(p,h){return o===1?p[h]:p.readUInt16BE(h*o)}let f;if(i){let p=-1;for(f=e;f<s;f++)if(a(t,f)===a(r,p===-1?0:f-p)){if(p===-1&&(p=f),f-p+1===c)return p*o}else p!==-1&&(f-=f-p),p=-1}else for(e+c>s&&(e=s-c),f=e;f>=0;f--){let p=!0;for(let h=0;h<c;h++)if(a(t,f+h)!==a(r,h)){p=!1;break}if(p)return f}return-1}u.prototype.includes=function(r,e,n){return this.indexOf(r,e,n)!==-1};u.prototype.indexOf=function(r,e,n){return ce(this,r,e,n,!0)};u.prototype.lastIndexOf=function(r,e,n){return ce(this,r,e,n,!1)};function ft(t,r,e,n){e=Number(e)||0;let i=t.length-e;n?(n=Number(n),n>i&&(n=i)):n=i;let o=r.length;n>o/2&&(n=o/2);let s;for(s=0;s<n;++s){let c=parseInt(r.substr(s*2,2),16);if(Sr(c))return s;t[e+s]=c}return s}function pt(t,r,e,n){return cr(Br(r,t.length-e),t,e,n)}function ht(t,r,e,n){return cr(bt(r),t,e,n)}function lt(t,r,e,n){return cr(ge(r),t,e,n)}function dt(t,r,e,n){return cr(Ut(r,t.length-e),t,e,n)}u.prototype.write=function(r,e,n,i){if(e===void 0)i="utf8",n=this.length,e=0;else if(n===void 0&&typeof e=="string")i=e,n=this.length,e=0;else if(isFinite(e))e=e>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let o=this.length-e;if((n===void 0||n>o)&&(n=o),r.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let s=!1;for(;;)switch(i){case"hex":return ft(this,r,e,n);case"utf8":case"utf-8":return pt(this,r,e,n);case"ascii":case"latin1":case"binary":return ht(this,r,e,n);case"base64":return lt(this,r,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return dt(this,r,e,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}};u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function yt(t,r,e){return r===0&&e===t.length?Ar.fromByteArray(t):Ar.fromByteArray(t.slice(r,e))}function ae(t,r,e){e=Math.min(t.length,e);let n=[],i=r;for(;i<e;){let o=t[i],s=null,c=o>239?4:o>223?3:o>191?2:1;if(i+c<=e){let a,f,p,h;switch(c){case 1:o<128&&(s=o);break;case 2:a=t[i+1],(a&192)===128&&(h=(o&31)<<6|a&63,h>127&&(s=h));break;case 3:a=t[i+1],f=t[i+2],(a&192)===128&&(f&192)===128&&(h=(o&15)<<12|(a&63)<<6|f&63,h>2047&&(h<55296||h>57343)&&(s=h));break;case 4:a=t[i+1],f=t[i+2],p=t[i+3],(a&192)===128&&(f&192)===128&&(p&192)===128&&(h=(o&15)<<18|(a&63)<<12|(f&63)<<6|p&63,h>65535&&h<1114112&&(s=h))}}s===null?(s=65533,c=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),i+=c}return gt(n)}var ne=4096;function gt(t){let r=t.length;if(r<=ne)return String.fromCharCode.apply(String,t);let e="",n=0;for(;n<r;)e+=String.fromCharCode.apply(String,t.slice(n,n+=ne));return e}function mt(t,r,e){let n="";e=Math.min(t.length,e);for(let i=r;i<e;++i)n+=String.fromCharCode(t[i]&127);return n}function wt(t,r,e){let n="";e=Math.min(t.length,e);for(let i=r;i<e;++i)n+=String.fromCharCode(t[i]);return n}function At(t,r,e){let n=t.length;(!r||r<0)&&(r=0),(!e||e<0||e>n)&&(e=n);let i="";for(let o=r;o<e;++o)i+=St[t[o]];return i}function xt(t,r,e){let n=t.slice(r,e),i="";for(let o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+n[o+1]*256);return i}u.prototype.slice=function(r,e){let n=this.length;r=~~r,e=e===void 0?n:~~e,r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),e<r&&(e=r);let i=this.subarray(r,e);return Object.setPrototypeOf(i,u.prototype),i};function l(t,r,e){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+r>e)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(r,e,n){r=r>>>0,e=e>>>0,n||l(r,e,this.length);let i=this[r],o=1,s=0;for(;++s<e&&(o*=256);)i+=this[r+s]*o;return i};u.prototype.readUintBE=u.prototype.readUIntBE=function(r,e,n){r=r>>>0,e=e>>>0,n||l(r,e,this.length);let i=this[r+--e],o=1;for(;e>0&&(o*=256);)i+=this[r+--e]*o;return i};u.prototype.readUint8=u.prototype.readUInt8=function(r,e){return r=r>>>0,e||l(r,1,this.length),this[r]};u.prototype.readUint16LE=u.prototype.readUInt16LE=function(r,e){return r=r>>>0,e||l(r,2,this.length),this[r]|this[r+1]<<8};u.prototype.readUint16BE=u.prototype.readUInt16BE=function(r,e){return r=r>>>0,e||l(r,2,this.length),this[r]<<8|this[r+1]};u.prototype.readUint32LE=u.prototype.readUInt32LE=function(r,e){return r=r>>>0,e||l(r,4,this.length),(this[r]|this[r+1]<<8|this[r+2]<<16)+this[r+3]*16777216};u.prototype.readUint32BE=u.prototype.readUInt32BE=function(r,e){return r=r>>>0,e||l(r,4,this.length),this[r]*16777216+(this[r+1]<<16|this[r+2]<<8|this[r+3])};u.prototype.readBigUInt64LE=v(function(r){r=r>>>0,$(r,"offset");let e=this[r],n=this[r+7];(e===void 0||n===void 0)&&z(r,this.length-8);let i=e+this[++r]*2**8+this[++r]*2**16+this[++r]*2**24,o=this[++r]+this[++r]*2**8+this[++r]*2**16+n*2**24;return BigInt(i)+(BigInt(o)<<BigInt(32))});u.prototype.readBigUInt64BE=v(function(r){r=r>>>0,$(r,"offset");let e=this[r],n=this[r+7];(e===void 0||n===void 0)&&z(r,this.length-8);let i=e*2**24+this[++r]*2**16+this[++r]*2**8+this[++r],o=this[++r]*2**24+this[++r]*2**16+this[++r]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(o)});u.prototype.readIntLE=function(r,e,n){r=r>>>0,e=e>>>0,n||l(r,e,this.length);let i=this[r],o=1,s=0;for(;++s<e&&(o*=256);)i+=this[r+s]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i};u.prototype.readIntBE=function(r,e,n){r=r>>>0,e=e>>>0,n||l(r,e,this.length);let i=e,o=1,s=this[r+--i];for(;i>0&&(o*=256);)s+=this[r+--i]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*e)),s};u.prototype.readInt8=function(r,e){return r=r>>>0,e||l(r,1,this.length),this[r]&128?(255-this[r]+1)*-1:this[r]};u.prototype.readInt16LE=function(r,e){r=r>>>0,e||l(r,2,this.length);let n=this[r]|this[r+1]<<8;return n&32768?n|4294901760:n};u.prototype.readInt16BE=function(r,e){r=r>>>0,e||l(r,2,this.length);let n=this[r+1]|this[r]<<8;return n&32768?n|4294901760:n};u.prototype.readInt32LE=function(r,e){return r=r>>>0,e||l(r,4,this.length),this[r]|this[r+1]<<8|this[r+2]<<16|this[r+3]<<24};u.prototype.readInt32BE=function(r,e){return r=r>>>0,e||l(r,4,this.length),this[r]<<24|this[r+1]<<16|this[r+2]<<8|this[r+3]};u.prototype.readBigInt64LE=v(function(r){r=r>>>0,$(r,"offset");let e=this[r],n=this[r+7];(e===void 0||n===void 0)&&z(r,this.length-8);let i=this[r+4]+this[r+5]*2**8+this[r+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(e+this[++r]*2**8+this[++r]*2**16+this[++r]*2**24)});u.prototype.readBigInt64BE=v(function(r){r=r>>>0,$(r,"offset");let e=this[r],n=this[r+7];(e===void 0||n===void 0)&&z(r,this.length-8);let i=(e<<24)+this[++r]*2**16+this[++r]*2**8+this[++r];return(BigInt(i)<<BigInt(32))+BigInt(this[++r]*2**24+this[++r]*2**16+this[++r]*2**8+n)});u.prototype.readFloatLE=function(r,e){return r=r>>>0,e||l(r,4,this.length),q.read(this,r,!0,23,4)};u.prototype.readFloatBE=function(r,e){return r=r>>>0,e||l(r,4,this.length),q.read(this,r,!1,23,4)};u.prototype.readDoubleLE=function(r,e){return r=r>>>0,e||l(r,8,this.length),q.read(this,r,!0,52,8)};u.prototype.readDoubleBE=function(r,e){return r=r>>>0,e||l(r,8,this.length),q.read(this,r,!1,52,8)};function w(t,r,e,n,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>i||r<o)throw new RangeError('"value" argument is out of bounds');if(e+n>t.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(r,e,n,i){if(r=+r,e=e>>>0,n=n>>>0,!i){let c=Math.pow(2,8*n)-1;w(this,r,e,n,c,0)}let o=1,s=0;for(this[e]=r&255;++s<n&&(o*=256);)this[e+s]=r/o&255;return e+n};u.prototype.writeUintBE=u.prototype.writeUIntBE=function(r,e,n,i){if(r=+r,e=e>>>0,n=n>>>0,!i){let c=Math.pow(2,8*n)-1;w(this,r,e,n,c,0)}let o=n-1,s=1;for(this[e+o]=r&255;--o>=0&&(s*=256);)this[e+o]=r/s&255;return e+n};u.prototype.writeUint8=u.prototype.writeUInt8=function(r,e,n){return r=+r,e=e>>>0,n||w(this,r,e,1,255,0),this[e]=r&255,e+1};u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(r,e,n){return r=+r,e=e>>>0,n||w(this,r,e,2,65535,0),this[e]=r&255,this[e+1]=r>>>8,e+2};u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(r,e,n){return r=+r,e=e>>>0,n||w(this,r,e,2,65535,0),this[e]=r>>>8,this[e+1]=r&255,e+2};u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(r,e,n){return r=+r,e=e>>>0,n||w(this,r,e,4,4294967295,0),this[e+3]=r>>>24,this[e+2]=r>>>16,this[e+1]=r>>>8,this[e]=r&255,e+4};u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(r,e,n){return r=+r,e=e>>>0,n||w(this,r,e,4,4294967295,0),this[e]=r>>>24,this[e+1]=r>>>16,this[e+2]=r>>>8,this[e+3]=r&255,e+4};function fe(t,r,e,n,i){ye(r,n,i,t,e,7);let o=Number(r&BigInt(4294967295));t[e++]=o,o=o>>8,t[e++]=o,o=o>>8,t[e++]=o,o=o>>8,t[e++]=o;let s=Number(r>>BigInt(32)&BigInt(4294967295));return t[e++]=s,s=s>>8,t[e++]=s,s=s>>8,t[e++]=s,s=s>>8,t[e++]=s,e}function pe(t,r,e,n,i){ye(r,n,i,t,e,7);let o=Number(r&BigInt(4294967295));t[e+7]=o,o=o>>8,t[e+6]=o,o=o>>8,t[e+5]=o,o=o>>8,t[e+4]=o;let s=Number(r>>BigInt(32)&BigInt(4294967295));return t[e+3]=s,s=s>>8,t[e+2]=s,s=s>>8,t[e+1]=s,s=s>>8,t[e]=s,e+8}u.prototype.writeBigUInt64LE=v(function(r,e=0){return fe(this,r,e,BigInt(0),BigInt("0xffffffffffffffff"))});u.prototype.writeBigUInt64BE=v(function(r,e=0){return pe(this,r,e,BigInt(0),BigInt("0xffffffffffffffff"))});u.prototype.writeIntLE=function(r,e,n,i){if(r=+r,e=e>>>0,!i){let a=Math.pow(2,8*n-1);w(this,r,e,n,a-1,-a)}let o=0,s=1,c=0;for(this[e]=r&255;++o<n&&(s*=256);)r<0&&c===0&&this[e+o-1]!==0&&(c=1),this[e+o]=(r/s>>0)-c&255;return e+n};u.prototype.writeIntBE=function(r,e,n,i){if(r=+r,e=e>>>0,!i){let a=Math.pow(2,8*n-1);w(this,r,e,n,a-1,-a)}let o=n-1,s=1,c=0;for(this[e+o]=r&255;--o>=0&&(s*=256);)r<0&&c===0&&this[e+o+1]!==0&&(c=1),this[e+o]=(r/s>>0)-c&255;return e+n};u.prototype.writeInt8=function(r,e,n){return r=+r,e=e>>>0,n||w(this,r,e,1,127,-128),r<0&&(r=255+r+1),this[e]=r&255,e+1};u.prototype.writeInt16LE=function(r,e,n){return r=+r,e=e>>>0,n||w(this,r,e,2,32767,-32768),this[e]=r&255,this[e+1]=r>>>8,e+2};u.prototype.writeInt16BE=function(r,e,n){return r=+r,e=e>>>0,n||w(this,r,e,2,32767,-32768),this[e]=r>>>8,this[e+1]=r&255,e+2};u.prototype.writeInt32LE=function(r,e,n){return r=+r,e=e>>>0,n||w(this,r,e,4,2147483647,-2147483648),this[e]=r&255,this[e+1]=r>>>8,this[e+2]=r>>>16,this[e+3]=r>>>24,e+4};u.prototype.writeInt32BE=function(r,e,n){return r=+r,e=e>>>0,n||w(this,r,e,4,2147483647,-2147483648),r<0&&(r=4294967295+r+1),this[e]=r>>>24,this[e+1]=r>>>16,this[e+2]=r>>>8,this[e+3]=r&255,e+4};u.prototype.writeBigInt64LE=v(function(r,e=0){return fe(this,r,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});u.prototype.writeBigInt64BE=v(function(r,e=0){return pe(this,r,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function he(t,r,e,n,i,o){if(e+n>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function le(t,r,e,n,i){return r=+r,e=e>>>0,i||he(t,r,e,4,34028234663852886e22,-34028234663852886e22),q.write(t,r,e,n,23,4),e+4}u.prototype.writeFloatLE=function(r,e,n){return le(this,r,e,!0,n)};u.prototype.writeFloatBE=function(r,e,n){return le(this,r,e,!1,n)};function de(t,r,e,n,i){return r=+r,e=e>>>0,i||he(t,r,e,8,17976931348623157e292,-17976931348623157e292),q.write(t,r,e,n,52,8),e+8}u.prototype.writeDoubleLE=function(r,e,n){return de(this,r,e,!0,n)};u.prototype.writeDoubleBE=function(r,e,n){return de(this,r,e,!1,n)};u.prototype.copy=function(r,e,n,i){if(!u.isBuffer(r))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),e>=r.length&&(e=r.length),e||(e=0),i>0&&i<n&&(i=n),i===n||r.length===0||this.length===0)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),r.length-e<i-n&&(i=r.length-e+n);let o=i-n;return this===r&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(e,n,i):Uint8Array.prototype.set.call(r,this.subarray(n,i),e),o};u.prototype.fill=function(r,e,n,i){if(typeof r=="string"){if(typeof e=="string"?(i=e,e=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!u.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(r.length===1){let s=r.charCodeAt(0);(i==="utf8"&&s<128||i==="latin1")&&(r=s)}}else typeof r=="number"?r=r&255:typeof r=="boolean"&&(r=Number(r));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;e=e>>>0,n=n===void 0?this.length:n>>>0,r||(r=0);let o;if(typeof r=="number")for(o=e;o<n;++o)this[o]=r;else{let s=u.isBuffer(r)?r:u.from(r,i),c=s.length;if(c===0)throw new TypeError('The value "'+r+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=s[o%c]}return this};var j={};function Ur(t,r,e){j[t]=class extends e{constructor(){super(),Object.defineProperty(this,"message",{value:r.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}Ur("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Ur("ERR_INVALID_ARG_TYPE",function(t,r){return`The "${t}" argument must be of type number. Received type ${typeof r}`},TypeError);Ur("ERR_OUT_OF_RANGE",function(t,r,e){let n=`The value of "${t}" is out of range.`,i=e;return Number.isInteger(e)&&Math.abs(e)>2**32?i=ie(String(e)):typeof e=="bigint"&&(i=String(e),(e>BigInt(2)**BigInt(32)||e<-(BigInt(2)**BigInt(32)))&&(i=ie(i)),i+="n"),n+=` It must be ${r}. Received ${i}`,n},RangeError);function ie(t){let r="",e=t.length,n=t[0]==="-"?1:0;for(;e>=n+4;e-=3)r=`_${t.slice(e-3,e)}${r}`;return`${t.slice(0,e)}${r}`}function Et(t,r,e){$(r,"offset"),(t[r]===void 0||t[r+e]===void 0)&&z(r,t.length-(e+1))}function ye(t,r,e,n,i,o){if(t>e||t<r){let s=typeof r=="bigint"?"n":"",c;throw o>3?r===0||r===BigInt(0)?c=`>= 0${s} and < 2${s} ** ${(o+1)*8}${s}`:c=`>= -(2${s} ** ${(o+1)*8-1}${s}) and < 2 ** ${(o+1)*8-1}${s}`:c=`>= ${r}${s} and <= ${e}${s}`,new j.ERR_OUT_OF_RANGE("value",c,t)}Et(n,i,o)}function $(t,r){if(typeof t!="number")throw new j.ERR_INVALID_ARG_TYPE(r,"number",t)}function z(t,r,e){throw Math.floor(t)!==t?($(t,e),new j.ERR_OUT_OF_RANGE(e||"offset","an integer",t)):r<0?new j.ERR_BUFFER_OUT_OF_BOUNDS:new j.ERR_OUT_OF_RANGE(e||"offset",`>= ${e?1:0} and <= ${r}`,t)}var Bt=/[^+/0-9A-Za-z-_]/g;function It(t){if(t=t.split("=")[0],t=t.trim().replace(Bt,""),t.length<2)return"";for(;t.length%4!==0;)t=t+"=";return t}function Br(t,r){r=r||1/0;let e,n=t.length,i=null,o=[];for(let s=0;s<n;++s){if(e=t.charCodeAt(s),e>55295&&e<57344){if(!i){if(e>56319){(r-=3)>-1&&o.push(239,191,189);continue}else if(s+1===n){(r-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(e<56320){(r-=3)>-1&&o.push(239,191,189),i=e;continue}e=(i-55296<<10|e-56320)+65536}else i&&(r-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((r-=1)<0)break;o.push(e)}else if(e<2048){if((r-=2)<0)break;o.push(e>>6|192,e&63|128)}else if(e<65536){if((r-=3)<0)break;o.push(e>>12|224,e>>6&63|128,e&63|128)}else if(e<1114112){if((r-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,e&63|128)}else throw new Error("Invalid code point")}return o}function bt(t){let r=[];for(let e=0;e<t.length;++e)r.push(t.charCodeAt(e)&255);return r}function Ut(t,r){let e,n,i,o=[];for(let s=0;s<t.length&&!((r-=2)<0);++s)e=t.charCodeAt(s),n=e>>8,i=e%256,o.push(i),o.push(n);return o}function ge(t){return Ar.toByteArray(It(t))}function cr(t,r,e,n){let i;for(i=0;i<n&&!(i+e>=r.length||i>=t.length);++i)r[i+e]=t[i];return i}function R(t,r){return t instanceof r||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===r.name}function Sr(t){return t!==t}var St=function(){let t="0123456789abcdef",r=new Array(256);for(let e=0;e<16;++e){let n=e*16;for(let i=0;i<16;++i)r[n+i]=t[e]+t[i]}return r}();function v(t){return typeof BigInt=="undefined"?Pt:t}function Pt(){throw new Error("BigInt not supported")}});var kt={};_e(kt,{Connector:()=>k,JsonRPCClient:()=>rr,JsonRPCServer:()=>G,MSafeServer:()=>vr,MSafeWallet:()=>B,MsafeWallet:()=>Mr,WalletEvent:()=>ar,WalletRPC:()=>Nr,adaptLegacyAccount:()=>_r,decode:()=>Ae,decodeFromStr:()=>V,encode:()=>O,encodeToStr:()=>K,toLegacyAccount:()=>W});var T=hr(gr());var H=hr(me());function Pr(t){let r=t.reduce((i,o)=>i+o.length,0),e=new Uint8Array(r),n=0;return t.forEach(i=>{e.set(i,n),n+=i.length}),e}var Fr=class{constructor(r,e=r.byteOffset){this.data=r;this.byteOffset=e}read(r){let e=new Uint8Array(this.data.buffer,this.byteOffset,r);return this.byteOffset+=r,e}decodeBigInt(){return BigInt(this.decodeString())}decodeNumber(){return Number(this.decodeString())}decodeUint8Array(){let r=new Uint32Array(this.read(4).slice(0).buffer)[0];return this.read(r)}decodeBoolean(){return Boolean(this.read(1)[0])}decodeString(){let r=this.decodeUint8Array();return H.Buffer.from(r).toString()}decodeArray(){let r=this.decode();return Array(r).fill(0).map(()=>this.decode())}decodeObject(){let r=this.decode(),e=Array(r).fill(0).map(()=>[this.decode(),this.decode()]);return Object.fromEntries(e)}decode(){let r=this.read(1)[0];switch(r){case 2:return this.decodeBigInt();case 1:return this.decodeNumber();case 0:return this.decodeBoolean();case 3:return this.decodeString();case 4:return this.decodeUint8Array();case 6:return this.decodeArray();case 5:return this.decodeObject();case 7:return;case 8:return null}throw`unkonw type: ${r}`}};function we(t){let r=new Uint8Array(t.length+5);return r[0]=4,H.Buffer.from(r.buffer,1,4).writeUInt32LE(t.length),r.set(t,5),r}function Ft(){return Uint8Array.from([7])}function Rt(){return Uint8Array.from([8])}function Tt(t){let r=Rr(t.toString());return r[0]=2,r}function Nt(t){let r=Rr(t.toString());return r[0]=1,r}function _t(t){return new Uint8Array([0,Number(t)])}function Rr(t){let r=new ArrayBuffer(t.length);H.Buffer.from(r).write(t);let e=we(new Uint8Array(r));return e[0]=3,e}function vt(t){let r=Object.entries(t),e=r.map(([n,i])=>{let o=O(n),s=O(i);return Pr([o,s])});return Pr([Uint8Array.from([5]),O(r.length),...e])}function Ct(t){let r=t.map(e=>O(e));return Pr([Uint8Array.from([6]),O(r.length),...r])}function O(t){if(t instanceof Uint8Array)return we(t);if(t instanceof Array)return Ct(t);if(t instanceof Object)return vt(t);if(t===null)return Rt();switch(typeof t){case"string":return Rr(t);case"number":return Nt(t);case"bigint":return Tt(t);case"boolean":return _t(t);case"undefined":return Ft()}throw`unsuport type: ${t}`}function Ae(t){return new Fr(t).decode()}function K(t){return H.Buffer.from(O(t).buffer).toString("hex")}function V(t){let r=new ArrayBuffer(t.length/2);return H.Buffer.from(r).write(t,"hex"),Ae(new Uint8Array(r))}var G=class{constructor(r,e){this.connector=r;this.methods=e;this.connector.on("message",n=>this.onRequest(n)),this.connector.on("close",()=>this.onClose())}onRequest(r){let e=(0,T.parse)(r);if(e.type!=="request")return;let n=this.methods[e.method];if(n===void 0){let i=T.format.error(e.id,new T.JsonRpcError("method not exist"));this.connector.send(i);return}n(...e.params.map(i=>V(i))).then(i=>{let o=T.format.response(e.id,K(i));this.connector.send(o)}).catch(i=>{let o=T.format.error(e.id,new T.JsonRpcError(String(i)));this.connector.send(o)})}notify(r,e){let n=T.format.notification(r,e.map(K));this.connector.send(n)}get version(){return this.connector.version}onClose(){}};function W(t){return{address:t.address,publicKey:Mt(t.publicKey,t.minKeysRequired)}}function Mt(t,r){let e=t.map(n=>n.startsWith("0x")?n.substring(2):n).join("");return e+=r.toString(16).padStart(2,"0"),"0x"+e}function xe(t,r){let e=f=>f.split(".").map(Number),[n,i,o]=e(t),[s,c,a]=e(r);return n>s?1:n<s?-1:i>c?1:i<c?-1:o>a?1:o<a?-1:0}function Z(t){return t!==void 0&&xe(t,"2.1.4")>=0}function Ee(t){return t!==void 0&&xe(t,"2.0.5")>=0}function Tr(t){return t!==void 0}function Be(t){return t!==void 0}var ar=(e=>(e.ChangeAccount="ChangeAccountEvent",e.ChangeNetwork="ChangeNetworkEvent",e))(ar||{}),Nr=(f=>(f.connect="connect",f.disconnect="disconnect",f.isConnected="isConnected",f.network="network",f.account="account",f.chainId="chainId",f.signAndSubmit="signAndSubmit",f.signTransaction="signTransaction",f.signMessage="signMessage",f))(Nr||{});function _r(t){return{connect(){return t.connect().then(r=>W(r))},disconnect(){return t.disconnect()},isConnected(){return t.isConnected()},network(){return t.network()},account(){return t.account().then(r=>W(r))},chainId(){return t.chainId()},signAndSubmit(r,e){return t.signAndSubmit(r,e)},signTransaction(r,e){return t.signTransaction(r,e)},signMessage(r){return t.signMessage(r)}}}var vr=class{constructor(r,e){if(Tr(r.version.peer))this.server=new G(r,e);else{let n=_r(e);this.server=new G(r,n)}}changeNetwork(r){this.server.notify("ChangeNetworkEvent",[r])}changeAccount(r){let e=this.version.peer;if(Tr(e))this.server.notify("ChangeAccountEvent",[r]);else{let n=W(r);this.server.notify("ChangeAccountEvent",[n])}}get version(){return this.server.version}};var Ie="6.1.0";var Cr=class{constructor(r,e,n){this.handshakeType=r,e!==void 0&&(this.version=e),n!==void 0&&(this.sessionID=n)}toString(r){if(Z(r)){if(this.sessionID===void 0)throw Error("sessionID is undefined");return`${this.handshakeType}:${this.version}:${this.sessionID}`}return Be(r)?`${this.handshakeType}:${this.version}`:this.handshakeType}isHandshakeMessage(r){return!(this.handshakeType!==r||Z(this.version)&&this.sessionID===void 0)}static fromString(r){let[e,n,i]=r.split(":");return new Cr(e,n,Number(i))}},d=Cr;d.HANDSHAKE_REQ="HANDSHAKE_REQ",d.HANDSHAKE_ACK="HANDSHAKE_ACK",d.HANDSHAKE_PORT_ACK="HANDSHAKE_PORT_REQ";var E=class{constructor(r,e,n){this.port=r;this.peerVersion=e;this.sessionID=n;this.connected=!0;this.port.onmessage=i=>{this.onMessage&&this.onMessage(i.data)},this.port.onmessageerror=()=>{this.close()}}send(r){this.port.postMessage(r)}on(r,e){switch(r){case"close":this.onClose=e;break;case"message":this.onMessage=e;break;default:throw Error("invalid type")}}get version(){return{self:E.version,peer:this.peerVersion}}close(){this.connected&&(this.port.close(),this.connected=!1,this.onClose&&this.onClose())}static newSessionID(){return E.sessionID++}static async connect(r,e){return new Promise((n,i)=>{let o=E.newSessionID(),s=()=>{},c=setTimeout(()=>{s(),i(`Connect MSafe wallet timeout: ${o}`)},1e3),a=p=>{let h=p.ports[0];if(!e.includes(p.origin)||typeof p.data!="string")return;let I=d.fromString(p.data);!I.isHandshakeMessage(d.HANDSHAKE_PORT_ACK)||I.sessionID===o&&(s(),n(new E(h,I.version,o)))};s=()=>{clearTimeout(c),window.removeEventListener("message",a)},window.addEventListener("message",a);let f=new d(d.HANDSHAKE_REQ,E.version,o);r.postMessage(f.toString(f.version),"*")})}static accepts(r,e){r=new URL(r).origin;let n=i=>{if(i.origin!==r||typeof i.data!="string")return;let o=d.fromString(i.data);if(!o.isHandshakeMessage(d.HANDSHAKE_REQ))return;let s=o.version,c=E.version;if(Z(s)){let a=new MessageChannel,f=new d(d.HANDSHAKE_PORT_ACK,c,o.sessionID);i.source.postMessage(f.toString(s),i.origin,[a.port2]),e(new E(a.port1,s,o.sessionID))}else if(Ee(s)){let a=new MessageChannel,f=new d(d.HANDSHAKE_PORT_ACK,c);i.source.postMessage(f.toString(s),i.origin,[a.port2]),e(new E(a.port1,s,void 0))}else{let a=i.ports[0],f=new d(d.HANDSHAKE_ACK,c);a.postMessage(f.toString(s)),e(new E(i.ports[0],s,void 0))}};return window.addEventListener("message",n),()=>window.removeEventListener("message",n)}static async accept(r){return new Promise(e=>{let n=this.accepts(r,i=>{e(i),n()})})}},k=E;k.version=Ie,k.sessionID=0;var fr=hr(gr());var rr=class{constructor(r,e){this.connector=r;this.notifiers=e;this.id=0;this.executors={};this.connector.on("message",n=>this.onMessage(n)),this.connector.on("close",()=>this.onClose())}onMessage(r){let e=(0,fr.parse)(r);switch(e.type){case"notification":return this.onNotify(e.method,e.params.map(V));case"response":let{resolve:n}=this.executors[Number(e.id)];return delete this.executors[Number(e.id)],n(V(e.result));case"error":let{reject:i}=this.executors[Number(e.id)];return delete this.executors[Number(e.id)],i(e.error.message)}}async request(r,e=[]){return new Promise((n,i)=>{let o=this.id++;this.executors[o]={resolve:n,reject:i};let s=fr.format.request(o,r,e.map(K));this.connector.send(s)})}get version(){return this.connector.version}onNotify(r,e){this.notifiers[r](...e)}onClose(){}};var Ue={mainnet:"https://aptos.m-safe.io",testnet:"https://aptos-testnet.m-safe.io",partner:"https://aptos-preview.m-safe.io",legacy1:"https://app.m-safe.io",legacy2:"https://testnet.m-safe.io",legacy3:"https://partner.m-safe.io",local:"http://localhost:5173"},be=Object.values(Ue),B=class{constructor(r){this.events={};let e=(o,...s)=>{let c=this.events[o];c&&c(s[0])},n=["ChangeAccountEvent","ChangeNetworkEvent"].map(o=>[o,(...s)=>e(o,...s)]),i=Object.fromEntries(n);this.client=new rr(r,i)}async connect(){return this.client.request("connect")}async isConnected(){return this.client.request("isConnected")}async disconnect(){return this.client.request("disconnect")}onChangeAccount(r){this.events["ChangeAccountEvent"]=r}onChangeNetwork(r){this.events["ChangeNetworkEvent"]=r}async network(){return this.client.request("network")}async account(){return this.client.request("account")}async chainId(){return this.client.request("chainId")}async signAndSubmit(r,e){return this.client.request("signAndSubmit",[r,e])}async signTransaction(r,e){return this.client.request("signTransaction",[r,e])}async signMessage(r){return this.client.request("signMessage",[r])}get version(){return this.client.version}static inMSafeWallet(){return typeof window!="undefined"&&typeof document!="undefined"&&typeof parent!="undefined"&&typeof parent.window!="undefined"&&parent.window!==window}static inMsafeWallet(){return B.inMSafeWallet()}static getAppUrl(r="mainnet",e=`${window.location.href}`){return`${B.getOrigin(r)}/store/0?url=${encodeURIComponent(e)}`}static getOrigin(r="mainnet"){let e=Ue[r.toLowerCase()]||r;return new URL(e).origin}static async new(r=be){let e=r instanceof Array?r.map(i=>B.getOrigin(i)):[B.getOrigin(r)],n=await k.connect(window.parent,be.map(i=>B.getOrigin(i)));return new B(n)}},Mr=class extends B{};return ve(kt);})();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
//# sourceMappingURL=index.global.js.map